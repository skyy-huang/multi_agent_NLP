# 多智能体学术写作优化系统 - Web界面

## 简介

这是一个现代化的Web图形界面，为多智能体学术写作优化系统提供直观、易用的操作体验。通过这个界面，用户可以轻松使用系统的所有功能，包括文本优化、数据合成、评估分析等。

## 主要特性

### 🎨 现代化界面设计
- 响应式设计，支持各种设备
- Bootstrap 5 + 自定义CSS样式
- 直观的标签页导航
- 实时进度显示

### 📝 文本优化功能
- **文本输入模式**: 直接输入要优化的文本
- **文件上传模式**: 支持长文件分段处理
- **实时进度**: WebSocket实时显示优化进度
- **多视图展示**: 对比视图、最终结果、轮次详情
- **智能配置**: 可调整轮次、语言、工具使用等参数

### 🔧 高级功能
- **数据合成**: 基于种子文本批量生成优化数据
- **评估分析**: 多维度指标评估系统性能
- **数据蒸馏**: 生成监督学习训练数据
- **配置管理**: 可视化API配置界面

### 📊 结果展示与下载
- **多格式下载**: 文本、HTML报告、JSON数据
- **详细分析**: 评分展示、轮次对比、差异高亮
- **报告生成**: 自动生成包含完整优化过程的HTML报告

### 🌟 高级学术评估指标 (NEW!)
- **9维度指标**: 全面评估学术文本质量
  - 学术规范性、引用完整性、创新度
  - 语言流畅度、句子平衡、论证强度
  - 表达多样性、结构完整性、时态一致
- **实时计算**: 优化完成后自动计算并显示
- **改进指示**: ↑↓→符号指示各维度的改进方向
- **可视化**: 进度条显示相对评分位置
- **颜色编码**: 绿(↑)/红(↓)/灰(→)直观显示改进幅度

## 安装与启动

### 1. 环境准备

确保已安装Python 3.8+和主项目依赖：

```bash
# 安装主项目依赖
pip install -r ../requirements.txt

# 安装Web界面依赖  
pip install -r requirements_web.txt
```

### 2. 配置环境变量

创建 `.env` 文件或在Web界面配置页面中设置：

```bash
OPENAI_API_KEY=your_openai_api_key
OPENAI_BASE_URL=https://api.chatanywhere.tech/v1
LLM_MODEL=gpt-4o-mini
SERPAPI_API_KEY=your_serpapi_key  # 可选，用于网络搜索
```

### 3. 启动Web服务

```bash
# 使用启动脚本（推荐）
python start_web.py

# 或直接运行Flask应用
python app.py
```

启动成功后访问: http://localhost:5000

## 界面功能详解

### 文本优化模块

#### 文本输入模式
1. 在文本框中输入要优化的学术文本
2. 设置优化需求（如"学术表达提升,逻辑结构优化"）
3. 配置高级参数（轮次、语言、工具开关）
4. 点击"开始优化"按钮

#### 文件上传模式
1. 选择文本文件（支持.txt, .md等格式）
2. 系统自动显示文件预览
3. 配置分段参数（适合长文件）:
   - 分段大小: 每段字符数（默认5000）
   - 重叠字符: 段间重叠字符数（默认200）
   - 最大段数: 限制处理段数（0=不限制）

#### 实时进度显示
- **状态指示器**: 显示当前任务状态
- **进度条**: 实时更新任务进度
- **日志输出**: 显示详细的处理日志

#### 结果展示
- **对比视图**: 并排显示原文与优化结果
- **最终结果**: 单独显示最终优化文本
- **轮次详情**: 展示每轮优化的详细过程
- **评分展示**: 质量、严谨性、逻辑、新颖性等维度评分

### 数据合成模块

1. 输入种子文本（每行一个）
2. 设置合成需求
3. 配置协作轮次
4. 系统自动生成大量训练数据

### 评估分析模块

1. 输入测试用例（格式: 文本|||需求1,需求2）
2. 系统执行多维度评估
3. 显示评估指标汇总

### 数据蒸馏模块

1. 上传之前生成的JSONL数据文件
2. 系统自动生成监督学习训练对
3. 可用于模型微调

## API接口说明

### 文本优化
- **POST** `/api/optimize/text` - 文本优化
- **POST** `/api/optimize/file` - 文件优化

### 数据处理
- **POST** `/api/synthesize` - 数据合成
- **POST** `/api/evaluate` - 评估分析
- **POST** `/api/distill` - 数据蒸馏

### 任务管理
- **GET** `/api/task/<task_id>` - 获取任务状态

### 文件下载
- **GET** `/api/download/<task_id>/text` - 下载优化文本
- **GET** `/api/download/<task_id>/html` - 下载HTML报告
- **GET** `/api/download/<task_id>/json` - 下载JSON数据

### 配置管理
- **POST** `/api/config` - 更新配置

## WebSocket事件

- `connect` - 客户端连接
- `disconnect` - 客户端断开
- `task_update` - 任务状态更新
- `join_task` - 加入任务房间

## 文件结构

```
web_interface/
├── app.py              # Flask应用主文件
├── start_web.py        # 启动脚本
├── index.html          # 主页面
├── requirements_web.txt # Web依赖
├── static/
│   ├── css/
│   │   └── styles.css  # 样式文件
│   └── js/
│       └── app.js      # 前端应用逻辑
└── data/              # 数据存储目录
```

## 技术栈

### 后端
- **Flask**: Web框架
- **Flask-SocketIO**: WebSocket支持
- **Flask-CORS**: 跨域支持

### 前端
- **Bootstrap 5**: UI框架
- **Socket.IO**: 实时通信
- **Vanilla JavaScript**: 核心逻辑

## 使用建议

### 1. 配置优化
- 首次使用时在配置页面设置API密钥
- 根据需要调整模型参数
- 长文本建议使用文件上传模式

### 2. 性能考虑
- 大文件建议设置合理的分段大小
- 多轮优化会增加处理时间
- 建议在服务器环境部署用于生产使用

### 3. 错误处理
- 检查API密钥是否正确配置
- 确保网络连接稳定
- 查看浏览器控制台获取详细错误信息

## 常见问题

**Q: 页面显示"连接失败"怎么办？**
A: 检查后端服务是否正常启动，确认端口5000未被占用。

**Q: 文件上传后没有反应？**
A: 检查文件大小是否超过50MB限制，确认文件格式是否支持。

**Q: 优化任务一直显示"处理中"？**
A: 检查API配置是否正确，查看后端日志获取详细错误信息。

**Q: 如何保存配置？**
A: 配置会自动保存到浏览器本地存储，API密钥等敏感信息不会保存到本地。

## 扩展开发

### 添加新功能
1. 在`app.py`中添加API端点
2. 在`index.html`中添加UI元素
3. 在`app.js`中实现前端逻辑
4. 在`styles.css`中添加样式

### 自定义样式
- 修改`styles.css`中的CSS变量
- 使用Bootstrap工具类快速调整布局
- 添加自定义动画和交互效果

## 许可证

与主项目保持一致的开源许可证。